<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>admin page</title>
  <script src='resources/record.js'></script>
  <script src="http://code.jquery.com/jquery-latest.min.js"></script>
  <script src="https://unpkg.com/@popperjs/core@2/dist/umd/popper.js"></script>
  <script src="https://unpkg.com/tippy.js@6"></script>
  <link rel="stylesheet" href="/css/admin.css">
  <script>
    window.onload = function() {

      <%  List<videoDT> memberVideo = (List<videoDT>) session.getAttribute("memberVideo");%>
    <%for(int i =0; i<memberVideo.size(); i++){%>
        $.ajax({
          url : "/web/memberName.do?video_seq=<%=memberVideo.get(i).getVideo_seq()%>",
          type :"GET",
          dataType : "text",
          contentType: 'application/json; charset=utf-8',
          success : function(result){

            var html ="<div class = 'name'>"+result+"</div>";
            $('#div_d<%=i%> div > div:nth-child(3)').html(html);
          },
          error : function(request,status,error){
            alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
          }
        });
        <%}%>

      function show1 () {
        document.querySelector(".black_bg").className = "black_bg show1";
      }
      function close1 () {
        document.querySelector(".black_bg").className = "black_bg";
      }

      document.querySelector("#modal_btn").addEventListener("click", show1);
      document.querySelector(".black_bg").addEventListener("click", close1);


      function onClick7() {
        var changeSrc= $(this).attr('src');
        $("#video").attr("src",changeSrc);

        document.querySelector('.record_wrap').style.display ='block';
        document.querySelector('.record_bg').style.display ='block';

      }

      function offClick7() {
        document.querySelector('.record_wrap').style.display ='none';
        document.querySelector('.record_bg').style.display ='none';
      }


      document.getElementById('record_video0').addEventListener('click', onClick7);
      document.querySelector('.record_bg').addEventListener('click', offClick7);

      document.getElementById('record_video1').addEventListener('click', onClick7);
      document.querySelector('.record_bg').addEventListener('click', offClick7);

      document.getElementById('record_video2').addEventListener('click', onClick7);
      document.querySelector('.record_bg').addEventListener('click', offClick7);

      document.getElementById('record_video3').addEventListener('click', onClick7);
      document.querySelector('.record_bg').addEventListener('click', offClick7);

      document.getElementById('record_video4').addEventListener('click', onClick7);
      document.querySelector('.record_bg').addEventListener('click', offClick7);

      document.getElementById('record_video5').addEventListener('click', onClick7);
      document.querySelector('.record_bg').addEventListener('click', offClick7);

      document.getElementById('record_video6').addEventListener('click', onClick7);
      document.querySelector('.record_bg').addEventListener('click', offClick7);

      document.getElementById('record_video7').addEventListener('click', onClick7);
      document.querySelector('.record_bg').addEventListener('click', offClick7);

      document.getElementById('record_video8').addEventListener('click', onClick7);
      document.querySelector('.record_bg').addEventListener('click', offClick7);

      document.getElementById('record_video9').addEventListener('click', onClick7);
      document.querySelector('.record_bg').addEventListener('click', offClick7);

      /* 달력 기본날짜 오늘날짜로 */
      today = new Date();

      console.log("today.toISOString() >>>" + today.toISOString());
      today = today.toISOString().slice(0, 10);
      console.log("today >>>> " + today);
      bir = document.getElementById("dates");
      bir.value = today;


      <%  guest member = (guest) session.getAttribute("member");%>

    }

    function go_main() { /* 아이콘 누르면 메인으로 */
      location.href = "/web/main.do";
    }
    function go_calender(){
      location.href = "/web/test.do";
    }

    function gomember(){
      location.href =  "/web/admin_member.do";
    }

    function gojoin(){
      location.href =  "/web/join.do";
    }

    function gorecord(){
      location.href =  "/web/admin.do";
    }

    function go_record(){
      location.href = "/web/record.do?user_id="+<%=member.getUser_id()%>;
    }



  </script>

</head>
<body>
<div class="black_bg">
  <div class="modal_wrap">
    <div class="modal_main">
      <div class = "modal_top">
        <div id="NSK_font" style = "font-size:80px;"><b><br>이진영 님</b></div>
        <div class = "modal_top_left">
          <div id="NSK_font"><br>만기일</div>
        </div>
        <div class = "modal_top_right">
          <div id="NSK_font"><br>2021-12-07<br>D-day 30일</div>
        </div>
      </div>
      <div class = "modal_mid">
        <div class = "modal_mid_mid">
          <div class = "modal_mid_left"><img id="moicon" src="image/diary.png" onclick = "gomember()"></div>
          <div class = "modal_mid_right"><b id = "modal_mid_b" onclick = "gomember()">회원 관리</b></div>
        </div>
        <div class = "modal_mid_mid">
          <div class = "modal_mid_left"><img id="moicon" src="image/dumbbell.png" onclick = "gojoin()"></div>
          <div class = "modal_mid_right"><b id = "modal_mid_b" onclick = "gojoin()">회원 가입</b></div>
        </div>
        <div class = "modal_mid_mid">
          <div class = "modal_mid_left"><img id="moicon" src="image/training.png" onclick = "gorecord()"></div>
          <div class = "modal_mid_right"><b id = "modal_mid_b" onclick = "gorecord()">회원 영상</b></div>
        </div>
      </div>
      <div class = "modal_bot">
        <div id="NSK_font">고객센터     010-4903-4073</div>
      </div>
    </div>
  </div>
</div>
<div class="record_bg"></div>
<div class="record_wrap">
  <div class="record_top" style="width:100%; height:200px;">
    <div id="record_top_title">
      <div class="ttleft"> 체스트프레스 </div>
      <div class="ttright"><img id="out" src="image/out.png" onclick = "go_record()"></div>
    </div>
    <hr style="border: solid 10px #f5f5f5;">
  </div>

  <div class="record_middle" style="width:100%; height:1000px;" align="center">
    <div id="record_middle_content">
      <video src="/cam/??.webm" id="video" controls="controls">
        <source src="/cam/??.webm"/>
      </video>
    </div>
  </div>

  <div style="width:70%; height:100px;"> </div>
</div>
<div class="main_map">


  <div class="main_top" style = "text-align : center;">
    <div class="top_left">
      <h1 style = "font-size:80px;">The Ai Fitness</h1>
    </div>
    <div class="top_right">
      <img id="modal_btn" src="image/menu.png"
           style="width: 120px; height: 120px;">
    </div>
  </div>
  <script>
    function test(){
      $.ajax({
        url :"/web/memberExinfo.do?user_id=<%=member.getUser_id()%>",
        method:"GET",
        dataType: 'json',
        success: function(data2) {
          $.each(data2, (index, obj)=>{
            var inD = 'div_d'+index;
            document.getElementById(inD).className = obj.ex_kinds;
          });

        }
      });
    }

    function insertdate(){
      var DATE = document.querySelector('input[type="date"]').value;
      $.ajax({
        url : "/web/dateVideo.do?user_id=<%=member.getUser_id()%>&video_date="+DATE,
        method :"GET",
        dataType : "text",
        async:false,
        success : function(result){
          location.href = "/web/"+result;
        },
        error : function(data){
          alert("error"+data);
        }

      })

    }


    <%-- $.ajax({
      url : /web/dateVideo.do?user_id=<%=member.getUser_id()%>&video_date="+DATE,
    }) --%>
  </script>
  <div class="main_mid">
    <div class="mid_top">
      <table style="padding-top: 40px;">
        <tr>
          <td style="padding-left: 50px;"><div id="change">
            <input onkeyup = "filter()" type = "text"
                   id="value" align ="center" placeholder = "이름 입력하세요">
            </input> </div></td>
          <td>

            <div class="select" data-role="selectBox" name="exercise" id="exercise" onclick = "test()">
                     <span date-value="optValue" class="selected-option">
                        <!-- 선택된 옵션 값이 출력되는 부분 -->
                     </span>
              <!-- 옵션 영역 -->
              <ul class="hide" id="wrap">
                <li class ="전체"><i><img src="image/menu.png" alt="전체"/></i>전체</li>
                <li class ="div_d"><i><img src="image/등.png"  alt="등" /></i>등</li>
                <li class ="div_p"><i><img src="image/팔.png" alt="팔" /></i>팔</li>
                <li class ="div_g"><i><img src="image/가슴.png" alt="가슴" /></i>가슴</li>
                <li class ="div_u"><i><img src="image/어깨.png" alt="어깨" /></i>어깨</li>
                <li class ="div_b"><i><img src="image/복근.png" alt="복근" /></i>복근</li>
              </ul>
            </div>
            <div id="choice"><i><img src="image/menu.png" alt="전체"/></i>전체</div>
          </td>
          <td></td>
        </tr>
      </table>
      <div>
        <ul>
          <li class="menu">
            <ul class="hide">
              <div>
              </div>
            </ul>
          </li>
        </ul>
      </div>
    </div>
    <div id="container">
      <c:forEach var= 'vo' items = "${memberVideo}" varStatus="status" >
        <c:set var="i" value="${i+1}"/>
        <div id = "div_d${status.index}" class="div_p${status.index}">
          <div class="item">
            <video src="/cam/${vo.file_name}.webm" class="${vo.video_seq}"
                   id="record_video${status.index}"></video>
            <div class="vida${i}">${vo.video_date}</div>
            <div class="vise${i}">${vo.video_seq}</div>
          </div>
        </div>
      </c:forEach>
    </div>

  </div>

  <div class="main_bot" id="NSK_font">
    <img id="gym2" align="bottom" src="image/gym2.png" width="150px" height="150px" onclick = "go_main()">
  </div>

</div>
<script> /* 컨테이너 */
var container = document.querySelector( '#container' );
var msnry = new Masonry( container, {
  // options
  columnWidth: 100,
  itemSelector: '.item',
} );


</script>
<script> /* 셀렉트 선택시 동영상 상자 */
$('.전체').click(function(){
  $('.등').show();
  $('.가슴').show();
  $('.팔').show();
  $('.어깨').show();
  $('.복근').show();
})
$('.div_d').click(function(){
  $('.등').show();
  $('.팔').hide();
  $('.가슴').hide();
  $('.어깨').hide();
  $('.복근').hide();
})
$('.div_p').click(function(){
  $('.팔').show();
  $('.등').hide();
  $('.가슴').hide();
  $('.어깨').hide();
  $('.복근').hide();
})
$('.div_g').click(function(){
  $('.가슴').show();
  $('.등').hide();
  $('.팔').hide();
  $('.어깨').hide();
  $('.복근').hide();
})
$('.div_u').click(function(){
  $('.어깨').show();
  $('.등').hide();
  $('.팔').hide();
  $('.가슴').hide();
  $('.복근').hide();
})
$('.duv_b').click(function(){
  $('.복근').show();
  $('.등').hide();
  $('.팔').hide();
  $('.가').hide();
  $('.div_u').hide();
})
</script>
<script type="text/javascript"> /* 셀렉트 */
const body = document.querySelector('body');
const select = document.querySelector(`[data-role="selectBox"]`);
const values = select.querySelector(`[date-value="optValue"]`);
const option = select.querySelector('ul');
const opts = option.querySelectorAll('li');
const choice = document.querySelector('#choice');

/* 셀렉트영역 클릭 시 옵션 숨기기, 보이기 */
function selects(e){
  e.stopPropagation();
  option.setAttribute('style',`top:${select.offsetHeight}px`)
  if(option.classList.contains('hide')){
    option.classList.remove('hide');
    option.classList.add('show');
  }else{
    option.classList.add('hide');
    option.classList.remove('show');
  }
  selectOpt();
  choice.classList.add('hide');
}

/* 옵션선택 */
function selectOpt(){
  opts.forEach(opt=>{
    const innerValue = opt.innerHTML;
    function changeValue(){
      values.innerHTML = innerValue;
    }
    opt.addEventListener('click',changeValue)
  });
}

/* 선택시 div보이게 */


/* 렌더링 시 옵션의 첫번째 항목 기본 선택 */
function selectFirst(){
  const firstValue = opts[0].innerHTML;
  values.innerHTML = `${firstValue}`
}



/* 옵션밖의 영역(=바디) 클릭 시 옵션 숨김 */
function hideSelect(){
  if(option.classList.contains('show')){
    option.classList.add('hide');
    option.classList.remove('show');
  }
}

selectFirst();
select.addEventListener('click',selects);
body.addEventListener('click',hideSelect);




</script>
<script type="text/javascript">
  function filter(){
    var value, name, item, i;

    value = document.getElementById("value").value.toUpperCase();
    item = document.getElementsByClassName("item");
    console.log(value);
    for(i=0;i<item.length;i++){
      name = item[i].getElementsByClassName("name");
      if(name[0].innerHTML.toUpperCase().indexOf(value) > -1){
        item[i].style.display = "flex";
      }else{
        item[i].style.display = "none";
      }
    }
  }
</script>
</body>
</html>